<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto News & Market Data</title>
    <meta name="description" content="Automated crypto news and real-time market data from Binance">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        .crypto-price { font-family: 'Courier New', monospace; font-weight: bold; }
        .price-up { color: #28a745; }
        .price-down { color: #dc3545; }
        .market-card { transition: transform 0.2s; }
        .market-card:hover { transform: translateY(-2px); }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-coins me-2"></i>
                Crypto News & Market Data
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container my-4">
        <!-- Hero Section -->
        <div class="jumbotron bg-gradient text-white text-center py-5 mb-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <div class="container">
                <h1 class="display-4">
                    <i class="fas fa-coins me-3"></i>
                    Crypto News & Market Data
                </h1>
                <p class="lead">
                    Real-time cryptocurrency market data and automated news updates
                </p>
                <p class="mb-0">
                    <i class="fas fa-sync-alt me-2"></i>
                    <span class="badge bg-light text-dark">Auto-updated every 2 hours</span>
                </p>
            </div>
        </div>

        <!-- Market Overview Section -->
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h3 class="mb-0">
                    <i class="fas fa-chart-line me-2 text-primary"></i>
                    Market Overview
                </h3>
                <small class="text-muted" id="last-updated">
                    Loading...
                </small>
            </div>
            <div class="card-body">
                <div id="market-data">
                    <div class="text-center py-4">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-3 text-muted">Loading market data...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- TradingView Chart -->
        <div class="card mb-4">
            <div class="card-header">
                <h5><i class="fas fa-chart-candlestick me-2"></i>BTC/USD Chart</h5>
            </div>
            <div class="card-body p-0">
                <div class="tradingview-widget-container" style="height:400px;width:100%">
                    <div id="tradingview_btc"></div>
                </div>
            </div>
        </div>

        <!-- Status Info -->
        <div class="alert alert-info">
            <h4 class="alert-heading"><i class="fas fa-info-circle me-2"></i>Site Status</h4>
            <p>This is your automated crypto news and market data website. The system fetches:</p>
            <ul class="mb-0">
                <li><strong>Market Data:</strong> Real-time prices from Binance API</li>
                <li><strong>News Articles:</strong> Latest crypto news from trusted sources</li>
                <li><strong>Updates:</strong> Automatic refresh every 2 hours</li>
            </ul>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-light mt-5 py-4">
        <div class="container text-center">
            <p class="text-muted mb-0">
                <i class="fas fa-sync-alt me-1"></i>
                Powered by Jekyll, GitHub Actions & Binance API
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- TradingView -->
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    
    <script>
        // Load market data
        fetch('./_data/market_data.json')
            .then(response => response.json())
            .then(data => {
                console.log('Market data loaded:', data);
                
                // Update last updated time
                if (data.last_updated) {
                    document.getElementById('last-updated').textContent = 
                        'Last updated: ' + new Date(data.last_updated).toLocaleString();
                }
                
                // Display market data
                const container = document.getElementById('market-data');
                if (data.coins && data.coins.length > 0) {
                    let html = '<div class="table-responsive">';
                    html += '<table class="table table-hover">';
                    html += '<thead class="table-dark">';
                    html += '<tr><th><i class="fas fa-coins me-1"></i>Symbol</th>';
                    html += '<th><i class="fas fa-dollar-sign me-1"></i>Price (USD)</th>';
                    html += '<th><i class="fas fa-percentage me-1"></i>24h Change</th>';
                    html += '<th><i class="fas fa-chart-bar me-1"></i>24h Volume</th></tr>';
                    html += '</thead><tbody>';
                    
                    data.coins.forEach(coin => {
                        const changePercent = parseFloat(coin.priceChangePercent);
                        const changeClass = changePercent < 0 ? 'price-down' : 'price-up';
                        const changeIcon = changePercent < 0 ? 'fa-arrow-down' : 'fa-arrow-up';
                        const changeSign = changePercent < 0 ? '' : '+';
                        
                        html += `<tr class="market-card">
                            <td><strong>${coin.symbol}</strong></td>
                            <td class="crypto-price">$${parseFloat(coin.lastPrice).toFixed(6)}</td>
                            <td class="${changeClass}">
                                <i class="fas ${changeIcon} me-1"></i>
                                ${changeSign}${changePercent.toFixed(2)}%
                            </td>
                            <td>$${parseFloat(coin.quoteVolume).toLocaleString()}</td>
                        </tr>`;
                    });
                    
                    html += '</tbody></table></div>';
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<p class="text-muted">Market data will appear here once the automated system runs.</p>';
                }
            })
            .catch(error => {
                console.error('Error loading market data:', error);
                document.getElementById('market-data').innerHTML = 
                    '<div class="alert alert-warning">Market data temporarily unavailable. The system will update automatically.</div>';
            });

        // TradingView chart
        new TradingView.widget({
            "autosize": true,
            "symbol": "BINANCE:BTCUSDT",
            "interval": "1H",
            "timezone": "Etc/UTC",
            "theme": "light",
            "style": "1",
            "locale": "en",
            "enable_publishing": false,
            "allow_symbol_change": true,
            "container_id": "tradingview_btc",
            "hide_top_toolbar": true,
            "hide_legend": true,
            "save_image": false
        });

        // Auto-refresh every 5 minutes
        setTimeout(function(){
            location.reload();
        }, 300000);
    </script>
</body>
</html>
