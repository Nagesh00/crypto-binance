<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸª™ Crypto News & Market Data - Live Tracking</title>
    <meta name="description" content="Real-time cryptocurrency market data and automated news updates">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        body { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; min-height: 100vh; }
        .hero { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 15px; padding: 2rem; margin: 2rem 0; }
        .crypto-card { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 10px; padding: 1rem; margin: 0.5rem 0; transition: transform 0.3s; }
        .crypto-card:hover { transform: translateY(-5px); background: rgba(255,255,255,0.15); }
        .price-up { color: #28a745; font-weight: bold; }
        .price-down { color: #dc3545; font-weight: bold; }
        .navbar { background: rgba(0,0,0,0.3) !important; backdrop-filter: blur(10px); }
        .status-badge { background: rgba(40, 167, 69, 0.2); border: 1px solid #28a745; padding: 0.5rem 1rem; border-radius: 20px; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#">
                <i class="fas fa-coins me-2"></i>
                Crypto Market Hub
            </a>
            <div class="status-badge">
                <i class="fas fa-sync-alt me-1"></i>
                <span id="status">Live</span>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Hero Section -->
        <div class="hero text-center">
            <h1 class="display-4 fw-bold mb-3">
                <i class="fas fa-chart-line me-3"></i>
                Crypto Market Dashboard
            </h1>
            <p class="lead mb-4">
                Real-time cryptocurrency prices and market analysis
            </p>
            <div class="row">
                <div class="col-md-4">
                    <div class="crypto-card">
                        <i class="fas fa-robot fa-2x mb-2"></i>
                        <h5>Auto-Updated</h5>
                        <p>Every 2 hours</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="crypto-card">
                        <i class="fas fa-shield-alt fa-2x mb-2"></i>
                        <h5>Secure API</h5>
                        <p>Binance & News APIs</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="crypto-card">
                        <i class="fas fa-mobile-alt fa-2x mb-2"></i>
                        <h5>Mobile Ready</h5>
                        <p>Responsive design</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Market Data -->
        <div class="row">
            <div class="col-lg-8">
                <div class="crypto-card">
                    <h3 class="mb-4">
                        <i class="fas fa-chart-bar me-2"></i>
                        Market Overview
                        <span class="float-end">
                            <small id="last-updated" class="text-light">Loading...</small>
                        </span>
                    </h3>
                    <div id="market-data">
                        <div class="text-center py-5">
                            <div class="spinner-border text-light" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-3">Fetching latest market data...</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="crypto-card">
                    <h5><i class="fas fa-info-circle me-2"></i>Site Status</h5>
                    <div class="mt-3">
                        <p><i class="fas fa-check-circle text-success me-2"></i>Automated Data Fetching</p>
                        <p><i class="fas fa-check-circle text-success me-2"></i>Real-time Price Updates</p>
                        <p><i class="fas fa-check-circle text-success me-2"></i>Mobile Responsive</p>
                        <p><i class="fas fa-check-circle text-success me-2"></i>GitHub Pages Hosted</p>
                    </div>
                </div>
                
                <div class="crypto-card mt-3">
                    <h5><i class="fas fa-chart-candlestick me-2"></i>Live Chart</h5>
                    <div id="tradingview-widget" style="height: 300px;">
                        <div class="text-center py-5">
                            <i class="fas fa-chart-line fa-3x mb-3 text-light"></i>
                            <p>Loading TradingView chart...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-5 py-4">
            <p class="text-light">
                <i class="fas fa-code me-2"></i>
                Powered by GitHub Actions, Binance API & Bootstrap
            </p>
            <p class="small text-light">
                <i class="fas fa-sync-alt me-1"></i>
                Last deployment: <span id="deploy-time">Now</span>
            </p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    
    <script>
        // Display current time
        document.getElementById('deploy-time').textContent = new Date().toLocaleString();
        
        // Load market data
        async function loadMarketData() {
            try {
                const response = await fetch('./_data/market_data.json');
                const data = await response.json();
                
                if (data.last_updated) {
                    document.getElementById('last-updated').textContent = 
                        'Updated: ' + new Date(data.last_updated).toLocaleString();
                }
                
                if (data.coins && data.coins.length > 0) {
                    let html = '<div class="table-responsive">';
                    html += '<table class="table table-dark table-hover">';
                    html += '<thead><tr>';
                    html += '<th><i class="fas fa-coins me-1"></i>Symbol</th>';
                    html += '<th><i class="fas fa-dollar-sign me-1"></i>Price</th>';
                    html += '<th><i class="fas fa-percentage me-1"></i>24h Change</th>';
                    html += '<th><i class="fas fa-chart-bar me-1"></i>Volume</th>';
                    html += '</tr></thead><tbody>';
                    
                    data.coins.forEach(coin => {
                        const change = parseFloat(coin.priceChangePercent);
                        const changeClass = change >= 0 ? 'price-up' : 'price-down';
                        const changeIcon = change >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                        const changeSign = change >= 0 ? '+' : '';
                        
                        html += `<tr>
                            <td><strong>${coin.symbol}</strong></td>
                            <td class="fw-bold">$${parseFloat(coin.lastPrice).toLocaleString()}</td>
                            <td class="${changeClass}">
                                <i class="fas ${changeIcon} me-1"></i>
                                ${changeSign}${change.toFixed(2)}%
                            </td>
                            <td>$${parseFloat(coin.quoteVolume).toLocaleString()}</td>
                        </tr>`;
                    });
                    
                    html += '</tbody></table></div>';
                    document.getElementById('market-data').innerHTML = html;
                    document.getElementById('status').textContent = 'Live';
                } else {
                    throw new Error('No coins data');
                }
            } catch (error) {
                console.error('Error loading market data:', error);
                document.getElementById('market-data').innerHTML = `
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        Market data is being prepared. Check back in a few minutes!
                    </div>`;
                document.getElementById('status').textContent = 'Preparing';
            }
        }

        // Load TradingView widget
        function loadTradingView() {
            try {
                new TradingView.widget({
                    "autosize": true,
                    "symbol": "BINANCE:BTCUSDT",
                    "interval": "1H",
                    "timezone": "Etc/UTC",
                    "theme": "dark",
                    "style": "1",
                    "locale": "en",
                    "enable_publishing": false,
                    "allow_symbol_change": true,
                    "container_id": "tradingview-widget",
                    "hide_top_toolbar": true,
                    "hide_legend": true
                });
            } catch (error) {
                document.getElementById('tradingview-widget').innerHTML = 
                    '<p class="text-center py-4">Chart loading...</p>';
            }
        }

        // Initialize
        loadMarketData();
        setTimeout(loadTradingView, 1000);
        
        // Auto-refresh every 5 minutes
        setInterval(loadMarketData, 300000);
    </script>
</body>
</html>
